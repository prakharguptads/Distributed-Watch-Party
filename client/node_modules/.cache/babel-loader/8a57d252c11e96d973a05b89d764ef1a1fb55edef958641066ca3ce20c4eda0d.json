{"ast":null,"code":"var _jsxFileName = \"/home/dell/Downloads/DD/Distributed-Watch-Party/client/src/components/Room/Room.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useContext } from 'react';\nimport { Container, Row, Col } from 'react-grid-system';\nimport Swal from 'sweetalert2';\nimport Topbar from '../common/Topbar';\nimport Player from './Player';\nimport Chat from './Chat/Chat';\nimport Options from './Options';\nimport { Spinner } from '../common/Spinner';\nimport { createConnection, bindSocketEvents } from '../../utils/socket';\nimport { getVideoId } from '../../utils/helper';\nimport { UserContext } from '../../contexts/UserContext';\nimport { SignalContext } from '../../contexts/SignalContext';\nfunction Room(props) {\n  _s();\n  const [isHost, setHost] = useState(false);\n  const [socket, setSocket] = useState(null);\n  const [roomLoading, setRoomLoading] = useState(true);\n  const {\n    dispatch: userDispatch,\n    userData\n  } = useContext(UserContext);\n  const {\n    dispatch: signalDispatch\n  } = useContext(SignalContext);\n  let _isHost = false;\n  let _socket = null;\n  const init = async () => {\n    const hostId = props.location.state && props.location.state.hostId;\n    const videoId = props.location.state && props.location.state.videoId;\n    let videoURL = props.location.state && props.location.state.joinUrl;\n    let username = props.location.state && props.location.state.username;\n    if (!hostId) {\n      // Not a host\n      _isHost = false;\n\n      // TODO: Show loading screen till connection is created\n      if (!username) {\n        // ask for username\n        const usernamePrompt = await Swal.fire({\n          title: 'Enter your display name',\n          input: 'text',\n          allowOutsideClick: false\n        });\n        username = usernamePrompt.value;\n      }\n      const roomId = props.match.params.id;\n      _socket = await createConnection(username, roomId, null, videoURL);\n      console.log(\"fdf\", videoURL);\n    } else {\n      _isHost = true;\n      _socket = props.location.socket;\n\n      // update videoid in global context\n      userDispatch({\n        type: 'UPDATE_VIDEO_ID',\n        videoId\n      });\n      showInviteModal();\n    }\n\n    // update username in global context\n    userDispatch({\n      type: 'UPDATE_USERNAME',\n      username\n    });\n    setHost(_isHost);\n    setSocket(_socket);\n    bindSocketEvents(_socket, {\n      userDispatch,\n      signalDispatch\n    });\n    console.log('is host', isHost);\n    setRoomLoading(false);\n  };\n  useEffect(() => {\n    init();\n  },\n  // eslint-disable-next-line\n  []);\n  const showInviteModal = async () => {\n    await Swal.fire({\n      title: 'Invite friends with this link',\n      input: 'text',\n      inputValue: window.location.href,\n      confirmButtonText: 'Copy',\n      inputAttributes: {\n        readOnly: true\n      },\n      width: '40%',\n      onClose: () => {\n        document.getElementsByClassName('swal2-input')[0].select();\n        document.execCommand('copy');\n      }\n    });\n  };\n  const askVideoURL = async () => {\n    const {\n      value: url\n    } = await Swal.fire({\n      title: 'YouTube Video URL',\n      input: 'url',\n      inputPlaceholder: 'https://www.youtube.com/watch?v=BTYAsjAVa3I'\n    });\n    return url;\n  };\n  const onVideoChange = async () => {\n    const newURL = await askVideoURL();\n    if (newURL && socket) {\n      console.log(_socket);\n      const videoId = getVideoId(newURL);\n      socket.emit('changeVideo', {\n        videoId\n      });\n    }\n  };\n  const alertNotImplemented = () => {\n    alert('Not implemented');\n  };\n  return /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(Topbar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 4\n    }\n  }), roomLoading ? /*#__PURE__*/React.createElement(Spinner, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 5\n    }\n  }) : /*#__PURE__*/React.createElement(Container, {\n    fluid: true,\n    style: {\n      margin: '0 3%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    md: 8,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Player, {\n    socket: socket,\n    videoId: userData.videoId,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 8\n    }\n  })), /*#__PURE__*/React.createElement(Col, {\n    md: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Options, {\n    onInvite: showInviteModal,\n    alertNotImplemented: alertNotImplemented,\n    onVideoChange: onVideoChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 8\n    }\n  }), /*#__PURE__*/React.createElement(Chat, {\n    socket: socket,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 8\n    }\n  })))));\n}\n_s(Room, \"mRQhuKHw3dbH5BCWLCvWfHpqtCM=\");\n_c = Room;\nexport default Room;\nvar _c;\n$RefreshReg$(_c, \"Room\");","map":{"version":3,"names":["React","useState","useEffect","useContext","Container","Row","Col","Swal","Topbar","Player","Chat","Options","Spinner","createConnection","bindSocketEvents","getVideoId","UserContext","SignalContext","Room","props","_s","isHost","setHost","socket","setSocket","roomLoading","setRoomLoading","dispatch","userDispatch","userData","signalDispatch","_isHost","_socket","init","hostId","location","state","videoId","videoURL","joinUrl","username","usernamePrompt","fire","title","input","allowOutsideClick","value","roomId","match","params","id","console","log","type","showInviteModal","inputValue","window","href","confirmButtonText","inputAttributes","readOnly","width","onClose","document","getElementsByClassName","select","execCommand","askVideoURL","url","inputPlaceholder","onVideoChange","newURL","emit","alertNotImplemented","alert","createElement","Fragment","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","fluid","style","margin","md","onInvite","_c","$RefreshReg$"],"sources":["/home/dell/Downloads/DD/Distributed-Watch-Party/client/src/components/Room/Room.js"],"sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport { Container, Row, Col } from 'react-grid-system';\nimport Swal from 'sweetalert2';\nimport Topbar from '../common/Topbar';\nimport Player from './Player';\nimport Chat from './Chat/Chat';\nimport Options from './Options';\nimport { Spinner } from '../common/Spinner';\nimport { createConnection, bindSocketEvents } from '../../utils/socket';\nimport { getVideoId } from '../../utils/helper';\nimport { UserContext } from '../../contexts/UserContext';\nimport { SignalContext } from '../../contexts/SignalContext';\n\nfunction Room(props) {\n\tconst [isHost, setHost] = useState(false);\n\tconst [socket, setSocket] = useState(null);\n\tconst [roomLoading, setRoomLoading] = useState(true);\n\n\tconst { dispatch: userDispatch, userData } = useContext(UserContext);\n\tconst { dispatch: signalDispatch } = useContext(SignalContext);\n\n\tlet _isHost = false;\n\tlet _socket = null;\n\n\tconst init = async () => {\n\t\tconst hostId = props.location.state && props.location.state.hostId;\n\t\tconst videoId = props.location.state && props.location.state.videoId;\n\t\tlet videoURL = props.location.state && props.location.state.joinUrl;\n\t\tlet username = props.location.state && props.location.state.username;\n\n\t\tif (!hostId) {\n\t\t\t// Not a host\n\t\t\t_isHost = false;\n\n\t\t\t// TODO: Show loading screen till connection is created\n\t\t\tif (!username) {\n\t\t\t\t// ask for username\n\t\t\t\tconst usernamePrompt = await Swal.fire({\n\t\t\t\t\ttitle: 'Enter your display name',\n\t\t\t\t\tinput: 'text',\n\t\t\t\t\tallowOutsideClick: false,\n\t\t\t\t});\n\t\t\t\tusername = usernamePrompt.value;\n\t\t\t}\n\n\t\t\tconst roomId = props.match.params.id;\n\t\t\t_socket = await createConnection(username, roomId, null, videoURL);\n\t\t\tconsole.log(\"fdf\",videoURL)\n\t\t} else {\n\t\t\t_isHost = true;\n\t\t\t_socket = props.location.socket;\n\n\t\t\t// update videoid in global context\n\t\t\tuserDispatch({ type: 'UPDATE_VIDEO_ID', videoId });\n\t\t\tshowInviteModal();\n\t\t}\n\n\t\t// update username in global context\n\t\tuserDispatch({ type: 'UPDATE_USERNAME', username });\n\n\t\tsetHost(_isHost);\n\t\tsetSocket(_socket);\n\t\tbindSocketEvents(_socket, {\n\t\t\tuserDispatch,\n\t\t\tsignalDispatch,\n\t\t});\n\n\t\tconsole.log('is host', isHost);\n\t\tsetRoomLoading(false);\n\t};\n\n\tuseEffect(\n\t\t() => {\n\t\t\tinit();\n\t\t}, // eslint-disable-next-line\n\t\t[]\n\t);\n\n\tconst showInviteModal = async () => {\n\t\tawait Swal.fire({\n\t\t\ttitle: 'Invite friends with this link',\n\t\t\tinput: 'text',\n\t\t\tinputValue: window.location.href,\n\t\t\tconfirmButtonText: 'Copy',\n\t\t\tinputAttributes: {\n\t\t\t\treadOnly: true,\n\t\t\t},\n\t\t\twidth: '40%',\n\t\t\tonClose: () => {\n\t\t\t\tdocument.getElementsByClassName('swal2-input')[0].select();\n\t\t\t\tdocument.execCommand('copy');\n\t\t\t},\n\t\t});\n\t};\n\n\tconst askVideoURL = async () => {\n\t\tconst { value: url } = await Swal.fire({\n\t\t\ttitle: 'YouTube Video URL',\n\t\t\tinput: 'url',\n\t\t\tinputPlaceholder: 'https://www.youtube.com/watch?v=BTYAsjAVa3I',\n\t\t});\n\n\t\treturn url;\n\t};\n\n\tconst onVideoChange = async () => {\n\t\tconst newURL = await askVideoURL();\n\n\t\tif (newURL && socket) {\n\t\t\tconsole.log(_socket);\n\t\t\tconst videoId = getVideoId(newURL);\n\t\t\tsocket.emit('changeVideo', { videoId });\n\t\t}\n\t};\n\n\tconst alertNotImplemented = () => {\n\t\talert('Not implemented');\n\t};\n\n\treturn (\n\t\t<React.Fragment>\n\t\t\t<Topbar />\n\t\t\t{roomLoading ? (\n\t\t\t\t<Spinner />\n\t\t\t) : (\n\t\t\t\t<Container fluid style={{ margin: '0 3%' }}>\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<Col md={8}>\n\t\t\t\t\t\t\t<Player\n\t\t\t\t\t\t\t\tsocket={socket}\n\t\t\t\t\t\t\t\tvideoId={userData.videoId}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t\t<Col md={4}>\n\t\t\t\t\t\t\t<Options\n\t\t\t\t\t\t\t\tonInvite={showInviteModal}\n\t\t\t\t\t\t\t\talertNotImplemented={alertNotImplemented}\n\t\t\t\t\t\t\t\tonVideoChange={onVideoChange}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Chat socket={socket} />\n\t\t\t\t\t\t</Col>\n\t\t\t\t\t</Row>\n\t\t\t\t</Container>\n\t\t\t)}\n\t\t</React.Fragment>\n\t);\n}\n\nexport default Room;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}