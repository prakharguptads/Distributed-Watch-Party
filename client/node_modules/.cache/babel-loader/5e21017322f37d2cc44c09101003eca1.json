{"ast":null,"code":"var _jsxFileName = \"/home/dell/DSparty/redparty/client/src/components/Room/Chat/Messages.js\";\nimport React, { useEffect, createRef } from 'react';\nimport styled from 'styled-components';\n\nfunction Messages(props) {\n  let messageEnd = createRef();\n  let messagesContainer = createRef();\n  const {\n    messages\n  } = props;\n\n  const scrollToBottom = () => {\n    if (!messagesContainer.current || !messageEnd.current) return;\n    const {\n      clientHeight,\n      scrollTop,\n      scrollHeight\n    } = messagesContainer.current; // totalMessage >= 1 always, because we have a dummy div as a permanent children\n\n    const totalMessage = messagesContainer.current.children.length;\n    const newMessage = messagesContainer.current.children[totalMessage - 2];\n    const lastMessage = totalMessage > 2 ? messagesContainer.current.children[totalMessage - 3] : null;\n    if (!newMessage || !lastMessage) return;\n    const newMessageHeight = newMessage.clientHeight;\n    const lastMessageHeight = lastMessage.clientHeight; // -15 for error margin\n\n    if (clientHeight + scrollTop + newMessageHeight + lastMessageHeight >= scrollHeight - 15) {\n      messageEnd.current.scrollIntoView();\n    }\n  };\n\n  useEffect(scrollToBottom, [messages]);\n  return /*#__PURE__*/React.createElement(MessagesContainer, {\n    ref: messagesContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 3\n    }\n  }, messages.map(message => /*#__PURE__*/React.createElement(Message, {\n    user: message.from,\n    key: message.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 5\n    }\n  }, message.text)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"dummy\",\n    ref: messageEnd,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 4\n    }\n  }));\n}\n\nconst Message = props => {\n  return props.user !== null ? /*#__PURE__*/React.createElement(MessageContainer, {\n    className: props.className,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(User, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 4\n    }\n  }, props.user), /*#__PURE__*/React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 4\n    }\n  }, props.children)) : /*#__PURE__*/React.createElement(MessageContainer, {\n    adminMessage: true,\n    className: props.className,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(Text, {\n    adminMessage: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 4\n    }\n  }, props.children));\n};\n\nconst MessagesContainer = styled.div`\n\tdisplay: flex;\n\tflex-direction: column;\n\tflex: 1;\n\tpadding: 5px;\n\tbox-sizing: border-box;\n\toverflow-y: auto;\n`;\nconst MessageContainer = styled.div`\n\tdisplay: flex;\n\tflex-direction: column;\n\tfont-size: 0.9em;\n\tmargin-bottom: 10px;\n\tbox-sizing: border-box;\n\n\t${({\n  adminMessage\n}) => adminMessage && {\n  'text-align': 'center',\n  color: 'gray'\n}}\n`;\nconst User = styled.div`\n\tfont-weight: 500;\n\tfont-size: 0.85em;\n\tmargin-bottom: 3px;\n\tmargin-left: 8px;\n`;\nconst Text = styled.div`\n\tpadding: 8px 10px;\n\tfont-weight: 500;\n\tfont-size: 0.9em;\n\tbackground-color: ${props => props.adminMessage ? 'transparent' : '#eee'};\n\twidth: ${props => props.adminMessage ? 'auto' : '80%'};\n\tborder-radius: 15px;\n`;\nexport default Messages;","map":{"version":3,"sources":["/home/dell/DSparty/redparty/client/src/components/Room/Chat/Messages.js"],"names":["React","useEffect","createRef","styled","Messages","props","messageEnd","messagesContainer","messages","scrollToBottom","current","clientHeight","scrollTop","scrollHeight","totalMessage","children","length","newMessage","lastMessage","newMessageHeight","lastMessageHeight","scrollIntoView","map","message","from","id","text","Message","user","className","MessagesContainer","div","MessageContainer","adminMessage","color","User","Text"],"mappings":"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","sourcesContent":["import React, { useEffect, createRef } from 'react';\nimport styled from 'styled-components';\n\nfunction Messages(props) {\n\tlet messageEnd = createRef();\n\tlet messagesContainer = createRef();\n\tconst { messages } = props;\n\n\tconst scrollToBottom = () => {\n\t\tif (!messagesContainer.current || !messageEnd.current) return;\n\n\t\tconst {\n\t\t\tclientHeight,\n\t\t\tscrollTop,\n\t\t\tscrollHeight,\n\t\t} = messagesContainer.current;\n\n\t\t// totalMessage >= 1 always, because we have a dummy div as a permanent children\n\t\tconst totalMessage = messagesContainer.current.children.length;\n\n\t\tconst newMessage = messagesContainer.current.children[totalMessage - 2];\n\t\tconst lastMessage =\n\t\t\ttotalMessage > 2\n\t\t\t\t? messagesContainer.current.children[totalMessage - 3]\n\t\t\t\t: null;\n\n\t\tif (!newMessage || !lastMessage) return;\n\n\t\tconst newMessageHeight = newMessage.clientHeight;\n\t\tconst lastMessageHeight = lastMessage.clientHeight;\n\n\t\t// -15 for error margin\n\t\tif (\n\t\t\tclientHeight + scrollTop + newMessageHeight + lastMessageHeight >=\n\t\t\tscrollHeight - 15\n\t\t) {\n\t\t\tmessageEnd.current.scrollIntoView();\n\t\t}\n\t};\n\n\tuseEffect(scrollToBottom, [messages]);\n\n\treturn (\n\t\t<MessagesContainer ref={messagesContainer}>\n\t\t\t{messages.map((message) => (\n\t\t\t\t<Message user={message.from} key={message.id}>\n\t\t\t\t\t{message.text}\n\t\t\t\t</Message>\n\t\t\t))}\n\t\t\t<div className='dummy' ref={messageEnd}></div>\n\t\t</MessagesContainer>\n\t);\n}\n\nconst Message = (props) => {\n\treturn props.user !== null ? (\n\t\t<MessageContainer className={props.className}>\n\t\t\t<User>{props.user}</User>\n\t\t\t<Text>{props.children}</Text>\n\t\t</MessageContainer>\n\t) : (\n\t\t<MessageContainer adminMessage className={props.className}>\n\t\t\t<Text adminMessage>{props.children}</Text>\n\t\t</MessageContainer>\n\t);\n};\n\nconst MessagesContainer = styled.div`\n\tdisplay: flex;\n\tflex-direction: column;\n\tflex: 1;\n\tpadding: 5px;\n\tbox-sizing: border-box;\n\toverflow-y: auto;\n`;\n\nconst MessageContainer = styled.div`\n\tdisplay: flex;\n\tflex-direction: column;\n\tfont-size: 0.9em;\n\tmargin-bottom: 10px;\n\tbox-sizing: border-box;\n\n\t${({ adminMessage }) =>\n\t\tadminMessage && { 'text-align': 'center', color: 'gray' }}\n`;\n\nconst User = styled.div`\n\tfont-weight: 500;\n\tfont-size: 0.85em;\n\tmargin-bottom: 3px;\n\tmargin-left: 8px;\n`;\n\nconst Text = styled.div`\n\tpadding: 8px 10px;\n\tfont-weight: 500;\n\tfont-size: 0.9em;\n\tbackground-color: ${(props) =>\n\t\tprops.adminMessage ? 'transparent' : '#eee'};\n\twidth: ${(props) => (props.adminMessage ? 'auto' : '80%')};\n\tborder-radius: 15px;\n`;\n\nexport default Messages;\n"]},"metadata":{},"sourceType":"module"}